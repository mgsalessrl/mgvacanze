var current_no_up;function thumb_setter(){"use strict";jQuery("#imagelist img").dblclick(function(){jQuery("#imagelist .uploaded_images .thumber").each(function(){jQuery(this).remove()}),jQuery(".fa-star").remove(),jQuery(this).parent().append('<i class="fas fa-star"></i>'),jQuery("#attachthumb").val(jQuery(this).parent().attr("data-imageid"))})}function delete_binder(){"use strict";jQuery("#imagelist i").unbind("click"),jQuery("#imagelist i.fa-trash-alt").on("click",function(){var n,s,e="",i="",t=jQuery(this).parent().attr("data-imageid"),o=jQuery("#wpestate_image_upload").val();--current_no_up,jQuery(this).parent().remove(),jQuery("#imagelist .uploaded_images").each(function(){e=e+","+jQuery(this).attr("data-imageid")}),jQuery("#attachid").val(e),n=jQuery("#propertyID").val(),jQuery("#attachthumb").val()===t&&jQuery("#attachthumb").val(""),s=ajaxcalls_vars.admin_url+"admin-ajax.php",jQuery.ajax({type:"POST",url:s,data:{action:"wpestate_delete_file",attach_id:t,propertyID:n,security:o},success:function(){},error:function(){}})})}jQuery(document).ready(function(e){"use strict";delete_binder();var t,n,s,o,i=0;current_no_up=parseInt(e(".uploaded_images ").length,10),t=0,typeof plupload!="undefined"&&(s=new plupload.Uploader(ajax_vars.plupload),s.init(),s.bind("FilesAdded",function(n,o){if(ajax_vars.max_images>0){if(current_no_up===0?(t=ajax_vars.max_images,o.length>ajax_vars.max_images?current_no_up=t:current_no_up=o.length):current_no_up>=ajax_vars.max_images?t=-1:(t=ajax_vars.max_images-current_no_up,o.length>t?current_no_up=current_no_up+t:current_no_up=current_no_up+o.length),t>0){n.files.slice(0,t),o.slice(0,t);for(var a=t;o.length>t;)n.files.pop(),o.pop(),i=1}if(i===1&&(e(".image_max_warn").remove(),e("#imagelist").before('<div class="image_max_warn" style="width:100%;float:left;">'+ajax_vars.warning_max+"</div>")),t==-1){e(".image_max_warn").remove(),e("#imagelist").before('<div class="image_max_warn" style="width:100%;float:left;">'+ajax_vars.warning_max+"</div>"),o=[],n=[];return}}e.each(o,function(t,n){e("#aaiu-upload-imagelist").append('<div id="'+n.id+'">'+n.name+" ("+plupload.formatSize(n.size)+") <b></b></div>")}),n.refresh(),s.start()}),s.bind("UploadProgress",function(t,n){e("#"+n.id+" b").html(n.percent+"%")}),s.bind("Error",function(t,n){e("#aaiu-upload-imagelist").append("<div>Error: "+n.code+", Message: "+n.message+(n.file?", File: "+n.file.name:"")+"</div>"),t.refresh()}),s.bind("FileUploaded",function(t,s,i){var a=parseInt(e(".uploaded_images ").length,10);if(ajax_vars.max_images>0&&a>ajax_vars.max_images)return;n=e.parseJSON(i.response),e("#image_warn").remove(),e("#"+s.id).remove(),n.success?(e("#profile-image").attr("src",n.html),e("#profile-image").attr("data-profileurl",n.html),e("#profile-image").attr("data-smallprofileurl",n.attach),o=e("#attachid").val(),o=o+","+n.attach,e("#attachid").val(o),n.html!==""?e("#imagelist").append('<div class="uploaded_images" data-imageid="'+n.attach+'"><img src="'+n.html+'"  /><i class="far fa-trash-alt"></i> </div>'):e("#imagelist").append('<div class="uploaded_images" data-imageid="'+n.attach+'"><img src="'+ajax_vars.path+'/img/pdf.png"  /><i class="far fa-trash-alt"></i> </div>'),e("#imagelist").sortable({revert:!0,update:function(){var o,s="";e("#imagelist .uploaded_images").each(function(){o=e(this).attr("data-imageid"),typeof o!="undefined"&&(s=s+","+o)}),e("#attachid").val(s)}}),delete_binder(),thumb_setter()):n.image&&e("#imagelist").before('<div id="image_warn" style="width:100%;float:left;">'+ajax_vars.warning+"</div>")}),e("#aaiu-uploader").on("click",function(e){s.start(),e.preventDefault()}),e("#aaiu-uploader2").on("click",function(e){s.start(),e.preventDefault()}),e("#aaiu-uploader-floor").on("click",function(t){t.preventDefault(),e("#aaiu-uploader").trigger("click")}))})