jQuery(document).ready(function(e){"use strict";e("#allinone_set_custom").on("click",function(){e("#allinone_set_custom").text(ajaxcalls_vars.saving),jQuery("#block_dates").is(":checked")?j():u()});function u(){var i=jQuery("#start_date_owner_book").val(),a=jQuery("#end_date_owner_book").val(),r=jQuery("#property_id").val(),c=jQuery("#new_custom_price").val(),o=jQuery("#period_min_days_booking").val(),e=jQuery("#period_extra_price_per_guest").val(),t=jQuery("#period_price_per_weekeend").val(),n=jQuery("#period_checkin_change_over").val(),s=jQuery("#period_checkin_checkout_change_over").val(),l=control_vars.admin_url+"admin-ajax.php",d=jQuery("#wprentals_allinone").val();jQuery.ajax({type:"POST",url:l,data:{action:"wpestate_ajax_add_allinone_custom",book_from:i,book_to:a,listing_id:r,new_price:c,period_min_days_booking:o,period_extra_price_per_guest:e,period_price_per_weekeend:t,period_checkin_change_over:n,period_checkin_checkout_change_over:s,security:d},success:function(){location.reload()},error:function(){}})}function j(){jQuery("#book_dates").empty().text(ajaxcalls_vars.saving),e=jQuery("#start_date_owner_book").val(),t=jQuery("#end_date_owner_book").val(),jQuery("#start_date_owner_book_hour").length>0&&(n=jQuery("#start_date_owner_book_hour").val(),e=e+" "+n,s=jQuery("#end_date_owner_book_hour").val(),t=t+" "+s);var e,t,n,s,o=jQuery("#listing_edit").val(),i=control_vars.admin_url+"admin-ajax.php",a=1,r=jQuery("#wprentals_allinone").val();jQuery.ajax({type:"POST",url:i,data:{action:"wpestate_ajax_check_booking_valability_internal",book_from:e,book_to:t,listing_id:o,internal:a,security:r,allinone:1},success:function(e){e.trim()==="run"?b():jQuery("#book_dates").empty().text(ajaxcalls_vars.reserve)},error:function(){}})}function b(){i=control_vars.admin_url+"admin-ajax.php",e=jQuery("#start_date_owner_book").val(),t=jQuery("#end_date_owner_book").val(),s=jQuery("#listing_edit").val(),a=jQuery("#book_notes").val(),n=jQuery("#booking_guest_no_wrapper").attr("data-value"),jQuery(".guest_no_hidden").length>0&&(n=parseInt(jQuery(".guest_no_hidden").val(),10)),jQuery("#start_date_owner_book_hour").length>0&&(r=jQuery("#start_date_owner_book_hour").val(),e=e+" "+r,c=jQuery("#end_date_owner_book_hour").val(),t=t+" "+c);var e,t,n,s,i,a,r,c,o=jQuery("#wprentals_allinone").val();jQuery.ajax({type:"POST",url:i,data:{action:"wpestate_ajax_add_booking",fromdate:e,todate:t,listing_edit:s,comment:a,booking_guest_no:n,confirmed:1,security:o,allinone:1},success:function(){u()},error:function(){}})}var t,n,s,o,r,x,E,k,A,S,M,F,c=0;e(".booking-calendar-wrapper-allinone .has_future").on("click",function(){if(o=0,n=0,e(this).hasClass("calendar-reserved")||e(this).hasClass("pick_block_dates"))return;if(e(this).addClass("calendar-selected"),c===0)c=1,e(this).addClass("calendar-reserved-start"),s=e(this).attr("data-curent-id"),e(".booking-calendar-wrapper-allinone .has_future[data-curent-id!="+s+"]").addClass("pick_block_dates");else{var n,o,i,a,r,s=e(this).attr("data-curent-id");c=0,e(this).addClass("calendar-reserved-stop"),i=e(this).parent().parent(),e('.has_future[data-curent-id="'+s+'"]').each(function(){e(this).hasClass("calendar-reserved-start")&&(n=1,a=e(this).attr("data-curent-date")),n===1&&e(this).hasClass("calendar-reserved")&&(o=1),e(this).hasClass("calendar-reserved-stop")&&(n=0,r=e(this).attr("data-curent-date"))}),e(".clean_reservation").show(),o==1&&e(".clean_reservation").hide(),e(".booking-calendar-wrapper-allinone .calendar-selected").removeClass("calendar-selected "),e(".booking-calendar-wrapper-allinone .has_future").removeClass("pick_block_dates calendar-reserved-stop calendar-reserved-start"),h(i,a,r,s)}});function h(e,t,n,s){var o=jQuery("#allinone_reservation_modal");o.appendTo("body"),jQuery("#allinone_reservation_modal").modal(),jQuery("#start_date_owner_book").val(wpestate_convert_selected_days_reverse(i(t))),jQuery("#end_date_owner_book").val(wpestate_convert_selected_days_reverse(i(n))),jQuery("#property_id").val(s),jQuery("#listing_edit").val(s)}e(".delete_custom_period a").on("click",function(t){t.preventDefault();var s=ajaxcalls_add_vars.admin_url+"admin-ajax.php",o=parseInt(jQuery(this).parent().attr("data-editid"),10),i=parseInt(jQuery(this).parent().attr("data-fromdate"),10),a=parseInt(jQuery(this).parent().attr("data-todate"),10),n=jQuery(this).parent().parent(),r=jQuery("#wprentals_delete_custom_period_nonce").val();e.ajax({type:"POST",url:s,data:{action:"wpestate_ajax_delete_custom_period",edit_id:o,from_date:i,to_date:a,security:r},success:function(){n.remove(),location.reload()},error:function(){}})}),e("#form_submit_1").on("click",function(){if(!e(this).hasClass("externalsubmit"))return;var n,s,o,i,a,r,c,l,d,u,h,m,f=jQuery("#title").val(),p=jQuery("#prop_category_submit").val(),g=jQuery("#prop_action_category_submit").val(),t=jQuery("#property_city").val();if((t===""||typeof t=="undefined")&&(t=jQuery("#property_city_front_autointernal").val()),s=0,jQuery("#instant_booking").is(":checked")&&(s=1),o=0,jQuery("#children_as_guests").is(":checked")&&(o=1),m=jQuery("#max_extra_guest_no").val(),n=0,jQuery("#overload_guest").is(":checked")&&(n=1),c=jQuery("#property_area_front").val(),l=jQuery("#property_country").val(),i=jQuery("#property_description").val(),u=jQuery("#guest_no").val(),d=jQuery("#property_affiliate").val(),h=jQuery("#new_estate").val(),r=jQuery("#security-login-submit").val(),a=ajaxcalls_add_vars.admin_url+"admin-ajax.php",wpestate_check_for_mandatory()){e([document.documentElement,document.body]).animate({scrollTop:e("#new_post").offset().top},500);return}jQuery(this).unbind("click"),e.ajax({type:"POST",url:a,data:{action:"wpestate_ajax_front_end_submit",title:f,prop_category:p,prop_action_category:g,property_city:t,property_area_front:c,property_country:l,property_description:i,guest_no:u,new_estate:h,instant_booking:s,children_as_guests:o,property_affiliate:d,overload_guest:n,max_extra_guest_no:m,security:r},success:function(e){jQuery("#new_estate").val(""),jQuery("#wp-login-but").attr("data-mixval",e),wpestate_show_login_form(1,0,e)},error:function(){}})}),t=2,n=1,s=parseInt(ajaxcalls_vars.max_month_no),e("#calendar-next").on("click",function(){t<s-2?++t:t=s,e(".booking-calendar-wrapper").hide(),e(".booking-calendar-wrapper").each(function(){var n=parseInt(e(this).attr("data-mno"),10);(n===t||n===t+1)&&e(this).fadeIn()})}),e("#calendar-prev").on("click",function(){t>3?--t:t=2,e(".booking-calendar-wrapper").hide(),e(".booking-calendar-wrapper").each(function(){var n=parseInt(e(this).attr("data-mno"),10);(n===t||n===t-1)&&e(this).fadeIn()})}),e("#calendar-next-internal").on("click",function(){t<s-2?++t:t=s-1,e(".booking-calendar-wrapper-in").hide(),e(".booking-calendar-wrapper-in").each(function(){var n=parseInt(e(this).attr("data-mno"),10);(n===t||n===t+1||n===t+2)&&e(this).css("display","inline-block")})}),e("#calendar-prev-internal").on("click",function(){t>3?--t:t=3,e(".booking-calendar-wrapper-in").hide(),e(".booking-calendar-wrapper-in").each(function(){var n=parseInt(e(this).attr("data-mno"),10);(n===t||n===t-1||n===t-2)&&e(this).css("display","inline-block")})}),e("#calendar-prev-internal-set").on("click",function(){n>1?--n:n=1,e(".booking-calendar-wrapper-in").hide(),e(".booking-calendar-wrapper-in").each(function(){var t=parseInt(e(this).attr("data-mno"),10);t===n&&e(this).css("display","inline-block")})}),e("#calendar-next-internal-set").on("click",function(){n<s-2?++n:n=s-1,e(".booking-calendar-wrapper-in").hide(),e(".booking-calendar-wrapper-in").each(function(){var t=parseInt(e(this).attr("data-mno"),10);t===n&&e(this).css("display","inline-block")})}),e("#calendar-prev-internal-allinone").on("click",function(){n>1?--n:n=1,e(".booking-calendar-wrapper-allinone").hide(),e(".booking-calendar-wrapper-allinone").each(function(){var t=parseInt(e(this).attr("data-mno"),10);t===n&&e(this).css("display","inline-block")})}),e("#calendar-next-internal-allinone").on("click",function(){n<s-2?++n:n=s-1,e(".booking-calendar-wrapper-allinone ").hide(),e(".booking-calendar-wrapper-allinone ").each(function(){var t=parseInt(e(this).attr("data-mno"),10);t===n&&e(this).css("display","inline-block")})}),e("#calendar-next-internal-price").on("click",function(){t<s-2?++t:t=s-1,e(".booking-calendar-wrapper-in-price").hide(),e(".booking-calendar-wrapper-in-price").each(function(){var n=parseInt(e(this).attr("data-mno"),10);(n===t||n===t+1)&&e(this).fadeIn()})}),e("#calendar-prev-internal-price").on("click",function(){t>2?--t:t=2,e(".booking-calendar-wrapper-in-price").hide(),e(".booking-calendar-wrapper-in-price").each(function(){var n=parseInt(e(this).attr("data-mno"),10);(n===t||n===t-1)&&e(this).fadeIn()})}),e("#close_custom_price_internal").on("click",function(){e(".booking-calendar-wrapper-in-price td").each(function(){e(this).removeClass("calendar-reserved-start-price"),e(this).removeClass("calendar-reserved-stop-price"),e(this).removeClass("calendar-reserved-price")})}),e("#close_reservation_internal").on("click",function(){var t=0;e(".calendar-reserved").each(function(){e(this).hasClass("calendar-reserved-start")&&(e(this).removeClass("calendar-reserved-start"),e(this).removeClass("calendar-reserved"),t=1),t===1&&e(this).removeClass("calendar-reserved"),e(this).hasClass("calendar-reserved-stop")&&(e(this).removeClass("calendar-reserved-stop"),e(this).removeClass("calendar-reserved"),t=0)})});function d(){return typeof wpestatePlacesApiAlerted!="undefined"?wpestatePlacesApiAlerted:!!(typeof window!="undefined"&&window.wpestatePlacesApiAlerted)}function l(){typeof wpestatePlacesApiAlerted!="undefined"?wpestatePlacesApiAlerted=!0:typeof window!="undefined"&&(window.wpestatePlacesApiAlerted=!0)}if(parseInt(mapbase_vars.wprentals_places_type)==1){const e=document.getElementById("property_city_front");if(!e||!control_vars.google_api_key);else{const t=document.createElement("ul");t.className="wpestate-autocomplete-results",e.parentNode.style.position="relative",e.parentNode.appendChild(t);let n=null;e.addEventListener("input",async function(){const s=e.value.trim();s.length<3&&(t.style.display="none"),n&&n.abort(),n=new AbortController;try{const e=await fetch("https://places.googleapis.com/v1/places:autocomplete",{method:"POST",signal:n.signal,headers:{"Content-Type":"application/json","X-Goog-Api-Key":control_vars.google_api_key,"X-Goog-FieldMask":"suggestions.placePrediction.text,suggestions.placePrediction.placeId"},body:JSON.stringify({input:s,includedRegionCodes:ajaxcalls_add_vars.limit_country==="yes"&&ajaxcalls_add_vars.limit_country_select?ajaxcalls_add_vars.limit_country_select:0[0]})});if(!e.ok){e.status===403&&!d()&&(l(),alert(control_vars.google_places_forbidden_message||"Google Places Autocomplete request was rejected (HTTP 403). Please verify the API key, billing status, and Places API configuration.")),console.error("Autocomplete fetch failed with status",e.status,e.statusText);return}const i=await e.json(),o=i.suggestions||[];if(t.innerHTML="",!o.length){t.style.display="none";return}o.forEach(e=>{const s=e.placePrediction.text.text,n=document.createElement("li");n.textContent=s,n.className="wpestate-autocomplete-item",n.addEventListener("click",()=>y(e.placePrediction.placeId,s)),t.appendChild(n)}),t.style.display="block"}catch(e){e.name!=="AbortError"&&console.error(e)}}),document.addEventListener("click",n=>{!t.contains(n.target)&&n.target!==e&&(t.style.display="none")});async function y(n,s){e.value=s,t.style.display="none";try{const e=await fetch(`https://places.googleapis.com/v1/places/${n}`,{method:"GET",headers:{"X-Goog-Api-Key":control_vars.google_api_key,"X-Goog-FieldMask":"id,formattedAddress,displayName,location,viewport,addressComponents,adrFormatAddress"}});if(!e.ok){e.status===403&&!d()&&(l(),alert(control_vars.google_places_forbidden_message||"Google Places Details request was rejected (HTTP 403). Please verify the API key, billing status, and Places API configuration.")),console.error("Place details fetch failed with status",e.status,e.statusText);return}const t=await e.json();if(!t||!t.addressComponents)return;const s=_(t);w(s)}catch(e){console.error("Place details fetch failed:",e)}}}}function _(e){const t=(e.addressComponents||[]).map(e=>{let t=[];Array.isArray(e.types)&&e.types.length?t=e.types:e.type&&(t=[e.type]);const n=e.type||e.types&&e.types[0]||"";return n==="administrative_area"&&(e.level?t=[`administrative_area_level_${e.level}`]:t=["administrative_area_level_1"]),{long_name:e.longText||"",short_name:e.shortText||"",types:t}});return{address_components:t,formatted_address:e.formattedAddress||"",name:e.displayName||"",geometry:{location:e.location||null,viewport:e.viewport||null},adr_address:e.adrFormatAddress||e.formattedAddress||""}}function w(t){if(!t||!t.address_components)return;let s=0,n="";const o={establishment:"long_name",street_number:"short_name",route:"long_name",locality:"long_name",administrative_area_level_1:"long_name",administrative_area_level_2:"long_name",administrative_area_level_3:"long_name",administrative_area_level_4:"long_name",country:"long_name",postal_code:"short_name",postal_code_prefix:"short_name",neighborhood:"long_name",colloquial_area:"long_name",natural_feature:"long_name",sublocality_level_1:"long_name",sublocality:"long_name"};for(let l=0;l<t.address_components.length;l++){const c=t.address_components[l];if(!c||!c.types||!c.types.length)continue;const i=c.types[0],d=o[i],r=d&&c[d]?c[d]:"";if(!r)continue;i==="sublocality_level_1"||i==="sublocality"||i==="neighborhood"?e("#property_area_front").val(r):i==="administrative_area_level_4"?n=a(n,r):i==="administrative_area_level_3"?n=a(n,r):i==="administrative_area_level_2"?n=a(n,r):i==="administrative_area_level_1"?n=a(n,r):i==="locality"||i==="colloquial_area"?(e("#property_city").val(r),s=1):(i==="country"||i==="natural_feature")&&(e("#property_country").val(r),s=1)}s===0&&t.adr_address&&O("property_city",t.adr_address),e("#property_city").val()!==""&&e("#property_admin_area").val(e("#property_city").val()+", "+n)}function O(t,n){var s=e(n).filter("span.locality").html();e("#"+t).val(s)}function a(t,n){return t===""?t=t+n:t=t+", "+n,e("#property_admin_area").val(t),t}function C(e){var t={query:e},n=new google.maps.places.PlacesService(map_city);n.textSearch(t,f)}function f(e,t){}function m(e,t,n){jQuery("#owner_price_modal").modal(),jQuery("#start_date_owner_book").val(wpestate_convert_selected_days_reverse(i(t))),jQuery("#end_date_owner_book").val(wpestate_convert_selected_days_reverse(i(n))),p()}function p(){var t,n,s,o,i,a,r,c,l,d,u,h;e("#set_price_dates").on("click",function(){jQuery("#book_dates").empty().text(ajaxcalls_vars.saving),c=jQuery("#start_date_owner_book").val(),l=jQuery("#end_date_owner_book").val(),d=jQuery("#listing_edit").val(),u=jQuery("#new_custom_price").val(),r=jQuery("#period_min_days_booking").val(),s=jQuery("#period_extra_price_per_guest").val(),o=jQuery("#period_price_per_weekeend").val(),i=jQuery("#period_checkin_change_over").val(),a=jQuery("#period_checkin_checkout_change_over").val(),n=jQuery("#period_week_price").val(),t=jQuery("#period_month_price").val(),h=control_vars.admin_url+"admin-ajax.php";var e=jQuery("#wprentals_custom_price").val();jQuery.ajax({type:"POST",url:h,data:{action:"wpestate_ajax_add_custom_price",book_from:c,book_to:l,listing_id:d,new_price:u,period_min_days_booking:r,period_extra_price_per_guest:s,period_price_per_weekeend:o,period_checkin_change_over:i,period_checkin_checkout_change_over:a,period_price_per_week:n,period_price_per_month:t,security:e},success:function(e){jQuery(this).removeClass("calendar-reserved-stop-price"),jQuery(this).removeClass("calendar-reserved-start-price"),jQuery("#owner_price_modal").modal("hide"),jQuery(".booking-calendar-wrapper-in-price .calendar-reserved-price .price-day").remove(),jQuery(".booking-calendar-wrapper-in-price .calendar-reserved-price .custom_set_price").remove(),jQuery(".booking-calendar-wrapper-in-price .calendar-reserved-price").append('<span class="custom_set_price">'+e+"</span>"),jQuery(".booking-calendar-wrapper-in-price .calendar-reserved-price").removeClass("calendar-reserved-price,calendar-reserved-start-price,calendar-reserved-stop-price"),jQuery("#book_dates").empty().text(ajaxcalls_vars.reserve),jQuery("#book_notes").val(""),jQuery(".booking-calendar-wrapper-in-price td").removeClass("calendar-reserved-stop-price"),jQuery(".booking-calendar-wrapper-in-price td").removeClass("calendar-reserved-start-price"),jQuery(".booking-calendar-wrapper-in-price td").removeClass("calendar-reserved-price"),location.reload()},error:function(){}})})}function g(e,t,n){jQuery("#owner_reservation_modal").modal();var s=control_vars.date_format.toUpperCase();t=moment.unix(t).utc().format(s),jQuery("#start_date_owner_book").val(t),n=moment.unix(n).utc().format(s),jQuery("#end_date_owner_book").val(n),v()}function v(){e("#book_dates").unbind("click"),e("#book_dates").on("click",function(){wpestate_check_booking_valability_internal()})}o=0,e(".booking-calendar-wrapper-in .has_future").on("click",function(){if(e(this).hasClass("calendar-reserved")){if(!e(this).hasClass("start_reservation"))return;if(o===0)return;e(this).addClass("calendar-selected")}else e(this).addClass("calendar-selected");var s,i,a,n=0;o===0?(o=1,e(this).addClass("calendar-reserved-start")):(o=0,e(this).addClass("calendar-reserved-stop"),s=e(this).parent().parent(),e(".has_future").each(function(){e(this).hasClass("calendar-reserved-start")&&(n=1,i=e(this).attr("data-curent-date")),e(this).hasClass("calendar-reserved-stop")&&(n=0,e(this).addClass("calendar-reserved"),a=e(this).attr("data-curent-date")),n===1&&e(this).addClass("calendar-reserved")}),e(".booking-calendar-wrapper-in .calendar-selected").removeClass("calendar-selected"),g(s,i,a))}),r=0,e(".booking-calendar-wrapper-in-price .has_future").on("click",function(){e(this).addClass("calendar-selected");var n,s,o,t=0;r===0?(r=1,e(this).addClass("calendar-reserved-start-price")):(r=0,e(this).addClass("calendar-reserved-stop-price"),n=e(this).parent().parent(),e(".has_future").each(function(){e(this).hasClass("calendar-reserved-start-price")&&(t=1,s=e(this).attr("data-curent-date")),e(this).hasClass("calendar-reserved-stop-price")&&(t=0,e(this).addClass("calendar-reserved-price"),o=e(this).attr("data-curent-date")),t===1&&e(this).addClass("calendar-reserved-price")}),e(".booking-calendar-wrapper-in-price .calendar-selected").removeClass("calendar-selected"),m(n,s,o))});function i(e){var t=new Date(e*1e3),n=t.getUTCFullYear(),s=t.getUTCMonth()+1,o=t.getUTCDate(),i=n+"-"+("0"+s).slice(-2)+"-"+o;return i}function T(e){var a=new Date,r=a.getTimezoneOffset(),t=new Date(e*1e3+r*6e4),n=t.getUTCFullYear(),s=t.getMonth()+1,o=t.getDate(),i=n+"-"+("0"+s).slice(-2)+"-"+o;return i}e("#edit_prop_ammenities").on("click",function(){if(n=jQuery("#listing_edit").val(),t="",e(".feature_list_save").each(function(){e(this).prop("checked")&&(t=t+e(this).attr("data-feature")+"~")}),wpestate_scrollToAnchor("all_wrapper"),wpestate_check_for_mandatory(1))return;var t,n,i,a,r,o=jQuery("#wprentals_amm_features_nonce").val(),s=ajaxcalls_add_vars.admin_url+"admin-ajax.php";e("#profile_message").empty().append('<div class="login-alert">'+ajaxcalls_vars.saving+"<div>"),e.ajax({type:"POST",url:s,dataType:"json",data:{action:"wpestate_ajax_update_listing_ammenities",listing_edit:n,custom_fields_amm:t,security:o},success:function(t){t.edited?e("#profile_message").empty().append('<div class="login-alert">'+t.response+"<div>"):e("#profile_message").empty().append('<div class="login-alert">'+t.response+"<div>");var n=jQuery(".next_submit_page").attr("href");window.location=n},error:function(){}})}),e("#edit_prop_locations").on("click",function(){if(l=JSON.parse(ajaxcalls_add_vars.tranport_custom_array),o=jQuery("#property_address").val(),i=jQuery("#property_zip").val(),n=jQuery("#property_county").val(),s=jQuery("#property_state").val(),a=jQuery("#property_latitude").val(),r=jQuery("#property_longitude").val(),c=jQuery("#google_camera_angle").val(),t=jQuery("#listing_edit").val(),wpestate_scrollToAnchor("all_wrapper"),wpestate_check_for_mandatory())return;var t,n,s,o,i,a,r,c,l,h,u=jQuery("#wprentals_edit_prop_locations_nonce").val(),d=ajaxcalls_add_vars.admin_url+"admin-ajax.php";e("#profile_message").empty().append('<div class="login-alert">'+ajaxcalls_vars.saving+"<div>"),e.ajax({type:"POST",url:d,dataType:"json",data:{action:"wpestate_ajax_update_listing_location",property_address:o,property_zip:i,property_latitude:a,property_longitude:r,google_camera_angle:c,property_state:s,property_county:n,listing_edit:t,security:u},success:function(t){t.edited?e("#profile_message").empty().append('<div class="login-alert">'+t.response+"<div>"):e("#profile_message").empty().append('<div class="login-alert">'+t.response+"<div>");var n=jQuery(".next_submit_page").attr("href");window.location=n},error:function(){}})}),e("#edit_calendar").on("click",function(){i=jQuery("#property_icalendar_import").val(),o=jQuery("#listing_edit").val(),s=ajaxcalls_add_vars.admin_url+"admin-ajax.php",e("#profile_message2").empty().append('<div class="login-alert">'+ajaxcalls_vars.saving+"<div>"),t=[],e(".property_icalendar_import_name_new").each(function(){t.push(e(this).val())}),n=[],e(".property_icalendar_import_feed_new").each(function(){n.push(e(this).val())});var t,n,s,o,i,r,a=jQuery("#wprentals_edit_calendar_nonce").val();e.ajax({type:"POST",url:s,dataType:"json",data:{action:"wpestate_ajax_update_ical_feed",property_icalendar_import:i,listing_edit:o,array_feeds:n,array_labels:t,security:a},success:function(t){t.edited?(e("#profile_message2").empty().append('<div class="login-alert">'+t.response+"<div>"),ajaxcalls_add_vars.submit_redirect!==""&&window.setTimeout(function(){window.location.href=ajaxcalls_add_vars.submit_redirect},3e3)):e("#profile_message2").empty().append('<div class="login-alert">'+t.response+"<div>")},error:function(){}})}),e(".delete_imported_dates_singular").on("click",function(t){t.preventDefault(),n=jQuery(this).attr("data-edit-id"),s=jQuery(this).attr("data-edit-id-key"),o=ajaxcalls_add_vars.admin_url+"admin-ajax.php",e(this).parent().remove();var n,s,o,a,i=jQuery("#wprentals_edit_calendar_nonce").val();e.ajax({type:"POST",url:o,data:{action:"wpestate_ajax_delete_imported_dates",edit_id:n,key:s,security:i},success:function(e){e=="done"&&location.reload()},error:function(){}})}),e("#edit_prop_details").on("click",function(){"use strict";r=jQuery("#property_size").val(),u=jQuery("#property_rooms").val(),f=jQuery("#property_bedrooms").val(),l=jQuery("#property_bathrooms").val(),d=jQuery("#listing_edit").val(),n="",i=JSON.parse(ajaxcalls_add_vars.tranport_custom_array);for(s=0;s<i.length;s++)m=i[s],o=e("#"+m).val(),typeof o=="undefined"&&(o=""),n=n+"~"+o;if(wpestate_scrollToAnchor("all_wrapper"),wpestate_check_for_mandatory())return;var t,n,s,o,i,a,r,l,d,u,h,m,f,p,g,v,b,j,y,_,w,c=[];e(".extra_detail_option_wrapper").each(function(){t="",t=e(this).find(".extra_option_name").val(),t=t+"|"+e(this).find(".extra_option_value ").val(),c.push(t)}),a=[],e(".beds_no ").each(function(){a.push(jQuery(this).val())}),g=jQuery("#cancellation_policy").val(),v=jQuery("#other_rules").val(),b=jQuery("input[name='smoking_allowed']:checked").val(),j=jQuery("input[name='pets_allowed']:checked").val(),y=jQuery("input[name='party_allowed']:checked").val(),_=jQuery("input[name='children_allowed']:checked").val(),p=ajaxcalls_add_vars.admin_url+"admin-ajax.php",e("#profile_message").empty().append('<div class="login-alert">'+ajaxcalls_vars.saving+"<div>"),h=jQuery("#wprentals_edit_prop_details_nonce").val(),e.ajax({type:"POST",url:p,dataType:"json",data:{action:"wpestate_ajax_update_listing_details",property_size:r,property_rooms:u,property_bedrooms:f,property_bathrooms:l,listing_edit:d,custom_fields_val:n,extra_details_options:c,beds_options:a,cancellation_policy:g,other_rules:v,smoking_allowed:b,pets_allowed:j,party_allowed:y,children_allowed:_,security:h},success:function(t){t.edited?e("#profile_message").empty().append('<div class="login-alert">'+t.response+"<div>"):e("#profile_message").empty().append('<div class="login-alert">'+t.response+"<div>");var n=jQuery(".next_submit_page").attr("href");window.location=n},error:function(){}})}),e("#edit_prop_image").on("click",function(){if(n=jQuery("#embed_video_type").val(),s=jQuery("#embed_video_id").val(),o=jQuery("#attachid").val(),i=jQuery("#attachthumb").val(),a=jQuery("#listing_edit").val(),r=jQuery("#virtual_tour").val(),t=ajaxcalls_add_vars.admin_url+"admin-ajax.php",wpestate_scrollToAnchor("all_wrapper"),wpestate_check_for_mandatory())return;var t,n,s,o,i,a,r,c=jQuery("#wprentals_edit_prop_image_nonce").val();e("#profile_message").empty().append('<div class="login-alert">'+ajaxcalls_vars.saving+"<div>"),e.ajax({type:"POST",url:t,dataType:"json",data:{action:"wpestate_ajax_update_listing_images",video_type:n,video_id:s,attachid:o,attachthumb:i,listing_edit:a,virtual_tour:r,security:c},success:function(t){t.edited?e("#profile_message").empty().append('<div class="login-alert">'+t.response+"<div>"):e("#profile_message").empty().append('<div class="login-alert">'+t.response+"<div>");var n=jQuery(".next_submit_page").attr("href");window.location=n},error:function(){}})}),e("#edit_prop_price").on("click",function(){if(u=jQuery("#local_booking_type").val(),y=jQuery("#property_price").val(),C=jQuery("#city_fee").val(),E=jQuery("#cleaning_fee").val(),k=jQuery("#property_label").val(),w=jQuery("#property_price_per_week").val(),O=jQuery("#property_price_per_month").val(),x=jQuery("#listing_edit").val(),h=jQuery("#property_taxes").val(),_=jQuery("#cleaning_fee_per_day").val(),f=jQuery("#city_fee_per_day").val(),d=jQuery("#security_deposit").val(),l=jQuery("#property_price_after_label").val(),c=jQuery("#property_price_before_label").val(),r=jQuery("#early_bird_percent").val(),b=jQuery("#early_bird_days").val(),n=[],p=jQuery("#booking_start_hour").val(),j=jQuery("#booking_end_hour").val(),e(".extra_pay_option").each(function(){t="",t=e(this).find(".extra_option_name").val(),t=t+"|"+e(this).find(".extra_option_value ").val(),t=t+"|"+e(this).find("select").val(),n.push(t)}),o=0,jQuery("#city_fee_percent").is(":checked")&&(o=1),s=0,jQuery("#price_per_guest_from_one").is(":checked")&&(s=1),m=jQuery("#min_days_booking").val(),a=jQuery("#extra_price_per_guest").val(),v=jQuery("#price_per_weekeend").val(),g=jQuery("#checkin_change_over").val(),i=jQuery("#checkin_checkout_change_over").val(),wpestate_scrollToAnchor("all_wrapper"),wpestate_check_for_mandatory())return;var t,n,s,o,i,a,r,c,l,d,u,h,m,f,p,g,v,b,j,y,_,w,O,x,C,E,k,M,S=jQuery("#wprentals_edit_prop_price_nonce").val(),A=ajaxcalls_add_vars.admin_url+"admin-ajax.php";e("#profile_message").empty().append('<div class="login-alert">'+ajaxcalls_vars.saving+"<div>"),e.ajax({type:"POST",url:A,dataType:"json",data:{action:"wpestate_ajax_update_listing_price",price:y,price_week:w,price_month:O,listing_edit:x,city_fee:C,cleaning_fee:E,cleaning_fee_per_day:_,city_fee_per_day:f,min_days_booking:m,price_per_guest_from_one:s,price_per_weekeend:v,checkin_change_over:g,checkin_checkout_change_over:i,extra_price_per_guest:a,property_taxes:h,security_deposit:d,property_price_after_label:l,property_price_before_label:c,early_bird_percent:r,early_bird_days:b,extra_pay_options:n,city_fee_percent:o,book_type:u,booking_start_hour:p,booking_end_hour:j,security:S},success:function(t){t.edited?e("#profile_message").empty().append('<div class="login-alert">'+t.response+"<div>"):e("#profile_message").empty().append('<div class="login-alert">'+t.response+"<div>");var n=jQuery(".next_submit_page").attr("href");window.location=n},error:function(){}})}),e("#edit_prop_1").on("click",function(){g=jQuery("#title").val(),i=jQuery("#prop_category_submit").val(),r=jQuery("#prop_action_category_submit").val(),c=jQuery("#guest_no").val(),t=jQuery("#property_city").val(),v=jQuery("#property_affiliate").val(),t===""&&(t=jQuery("#property_city_front_autointernal").val()),ajaxcalls_add_vars.wpestate_autocomplete==="no"&&(t=jQuery("#property_city_front_autointernal").val()),s=0,jQuery("#instant_booking").is(":checked")&&(s=1);var t,n,s,o,i,a,r,c,l,d,u,h,m,f,p,g,v,b,y,j=0;if(jQuery("#wp_estate_replace_booking_form_local").is(":checked")&&(j=1),o=0,jQuery("#children_as_guests").is(":checked")&&(o=1),l=jQuery("#max_extra_guest_no").val(),n=0,jQuery("#overload_guest").is(":checked")&&(n=1),u=jQuery("#property_area_front").val(),d=jQuery("#property_country").val(),a=jQuery("#listing_edit").val(),m=jQuery("#property_description").val(),f=jQuery("#property_admin_area").val(),b=jQuery("#private_notes").val(),p=jQuery("#checkin-message").val(),h=ajaxcalls_add_vars.admin_url+"admin-ajax.php",wpestate_scrollToAnchor("all_wrapper"),wpestate_check_for_mandatory())return;y=jQuery("#wprentals_edit_prop_1_nonce").val(),e("#profile_message").empty().append('<div class="login-alert">'+ajaxcalls_vars.saving+"<div>"),e.ajax({type:"POST",url:h,dataType:"json",data:{action:"wpestate_ajax_update_listing_description",title:g,category:i,action_category:r,guests:c,city:t,area:u,country:d,listing_edit:a,prop_desc:m,property_admin_area:f,instant_booking:s,wp_estate_replace_booking_form_local:j,children_as_guests:o,aff_link:v,private_notes:b,checkin_message:p,overload_guest:n,max_extra_guest_no:l,security:y},success:function(t){if(t.edited){e("#profile_message").empty().append('<div class="login-alert">'+t.response+"<div>");var n=jQuery(".next_submit_page").attr("href");window.location=n}else e("#profile_message").empty().append('<div class="login-alert">'+t.response+"<div>")},error:function(){}})})});function wpestate_scrollToAnchor(e){var t=jQuery("#"+e);jQuery("html,body").animate({scrollTop:t.offset().top},"slow")}function wpestate_check_for_mandatory(){var t="";return ajaxcalls_add_vars.mandatory_fields.constructor===Array&&ajaxcalls_add_vars.mandatory_fields.forEach(function(e){var n=e;e=e.replace(/%/g,""),jQuery("#"+e).length>0&&(jQuery("#"+e).is(":checkbox")&&!jQuery("#"+e).prop("checked")&&(t=wpestate_build_warning(t,n)),jQuery("#"+e).val()===""&&(t=wpestate_build_warning(t,n)),(e==="prop_category_submit"||e==="prop_action_category_submit")&&jQuery("#"+e).val()==="-1"&&(t=wpestate_build_warning(t,n)),(e=="checkin_change_over"||e=="checkin_checkout_change_over")&&jQuery("#"+e).val()==="0"&&(t=wpestate_build_warning(t,n)))}),t!==""&&(jQuery("#profile_message").empty().append('<div class="login-alert alert_err">'+ajaxcalls_add_vars.pls_fill+": "+t+"<div>"),!0)}function wpestate_build_warning(e,t){return e===""?e=e+ajaxcalls_add_vars.mandatory_fields_label[t]:e=e+", "+ajaxcalls_add_vars.mandatory_fields_label[t],e}